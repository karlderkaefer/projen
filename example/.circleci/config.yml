# ~~ Generated by projen. To modify, edit .projenrc.js and run "npx projen".

version: "2.1"
orbs:
  cdk: signavio/cdk-orb@0.10.8
workflows:
  build:
    jobs:
      - cdk/test:
          context:
            - NPM
      - cdk/sonarqube:
          requires:
            - cdk/test
          context:
            - NPM
            - Sonarqube
      - cdk/publish:
          requires:
            - cdk/test
          context:
            - npm-github
          filters:
            - branches:
                only:
                  - master
                  - main
      - cdk/deploy:
          name: diff-staging_eu
          account-id: "123"
          command: diff
          post-diff: true
          requires:
            - cdk/test
          context:
            - npm-github
            - CDK
      - cdk/deploy:
          name: deploy-staging_eu
          account-id: "123"
          enable-docker: true
          command: deploy
          post-diff: true
          requires:
            - cdk/test
            - diff-staging_eu
          context:
            - npm-github
            - CDK
          filters:
            - branches:
                only:
                  - master
                  - main
      - cdk/deploy:
          name: diff-staging_uk
          account-id: "1234"
          command: diff
          post-diff: true
          requires:
            - cdk/test
          context:
            - npm-github
            - CDK
      - cdk/deploy:
          name: deploy-staging_uk
          account-id: "1234"
          enable-docker: true
          command: deploy
          post-diff: true
          requires:
            - cdk/test
            - diff-staging_uk
          context:
            - npm-github
            - CDK
          filters:
            - branches:
                only:
                  - master
                  - main
